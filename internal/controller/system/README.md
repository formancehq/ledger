<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# system

```go
import "github.com/formancehq/ledger/internal/controller/system"
```

System Controller doc

## Index

- [Variables](<#variables>)
- [func NewFXModule\(configuration ModuleConfiguration\) fx.Option](<#NewFXModule>)
- [type Controller](<#Controller>)
- [type DefaultController](<#DefaultController>)
  - [func NewDefaultController\(store Store, listener ledgercontroller.Listener, opts ...Option\) \*DefaultController](<#NewDefaultController>)
  - [func \(ctrl \*DefaultController\) CreateLedger\(ctx context.Context, name string, configuration ledger.Configuration\) error](<#DefaultController.CreateLedger>)
  - [func \(ctrl \*DefaultController\) DeleteLedgerMetadata\(ctx context.Context, param string, key string\) error](<#DefaultController.DeleteLedgerMetadata>)
  - [func \(ctrl \*DefaultController\) GetLedger\(ctx context.Context, name string\) \(\*ledger.Ledger, error\)](<#DefaultController.GetLedger>)
  - [func \(ctrl \*DefaultController\) GetLedgerController\(ctx context.Context, name string\) \(ledgercontroller.Controller, error\)](<#DefaultController.GetLedgerController>)
  - [func \(ctrl \*DefaultController\) ListLedgers\(ctx context.Context, query ledgercontroller.ListLedgersQuery\) \(\*bunpaginate.Cursor\[ledger.Ledger\], error\)](<#DefaultController.ListLedgers>)
  - [func \(ctrl \*DefaultController\) UpdateLedgerMetadata\(ctx context.Context, name string, m map\[string\]string\) error](<#DefaultController.UpdateLedgerMetadata>)
- [type ModuleConfiguration](<#ModuleConfiguration>)
- [type Option](<#Option>)
  - [func WithCompiler\(compiler ledgercontroller.Compiler\) Option](<#WithCompiler>)
- [type Store](<#Store>)


## Variables

<a name="ErrNeedUpgradeBucket"></a>

```go
var (
    ErrNeedUpgradeBucket   = errors.New("need to upgrade bucket before add a new ledger on it")
    ErrLedgerAlreadyExists = errors.New("ledger already exists")
)
```

<a name="NewFXModule"></a>
## func [NewFXModule](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/module.go#L13>)

```go
func NewFXModule(configuration ModuleConfiguration) fx.Option
```



<a name="Controller"></a>
## type [Controller](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L13-L24>)



```go
type Controller interface {
    GetLedgerController(ctx context.Context, name string) (ledgercontroller.Controller, error)
    GetLedger(ctx context.Context, name string) (*ledger.Ledger, error)
    ListLedgers(ctx context.Context, query ledgercontroller.ListLedgersQuery) (*bunpaginate.Cursor[ledger.Ledger], error)
    // CreateLedger can return following errors:
    //  * ErrLedgerAlreadyExists
    //  * ledger.ErrInvalidLedgerName
    // It create the ledger in system store and the underlying storage
    CreateLedger(ctx context.Context, name string, configuration ledger.Configuration) error
    UpdateLedgerMetadata(ctx context.Context, name string, m map[string]string) error
    DeleteLedgerMetadata(ctx context.Context, param string, key string) error
}
```

<a name="DefaultController"></a>
## type [DefaultController](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L26-L31>)



```go
type DefaultController struct {
    // contains filtered or unexported fields
}
```

<a name="NewDefaultController"></a>
### func [NewDefaultController](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L97>)

```go
func NewDefaultController(store Store, listener ledgercontroller.Listener, opts ...Option) *DefaultController
```



<a name="DefaultController.CreateLedger"></a>
### func \(\*DefaultController\) [CreateLedger](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L61>)

```go
func (ctrl *DefaultController) CreateLedger(ctx context.Context, name string, configuration ledger.Configuration) error
```



<a name="DefaultController.DeleteLedgerMetadata"></a>
### func \(\*DefaultController\) [DeleteLedgerMetadata](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L91>)

```go
func (ctrl *DefaultController) DeleteLedgerMetadata(ctx context.Context, param string, key string) error
```



<a name="DefaultController.GetLedger"></a>
### func \(\*DefaultController\) [GetLedger](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L73>)

```go
func (ctrl *DefaultController) GetLedger(ctx context.Context, name string) (*ledger.Ledger, error)
```



<a name="DefaultController.GetLedgerController"></a>
### func \(\*DefaultController\) [GetLedgerController](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L33>)

```go
func (ctrl *DefaultController) GetLedgerController(ctx context.Context, name string) (ledgercontroller.Controller, error)
```



<a name="DefaultController.ListLedgers"></a>
### func \(\*DefaultController\) [ListLedgers](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L79>)

```go
func (ctrl *DefaultController) ListLedgers(ctx context.Context, query ledgercontroller.ListLedgersQuery) (*bunpaginate.Cursor[ledger.Ledger], error)
```



<a name="DefaultController.UpdateLedgerMetadata"></a>
### func \(\*DefaultController\) [UpdateLedgerMetadata](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L85>)

```go
func (ctrl *DefaultController) UpdateLedgerMetadata(ctx context.Context, name string, m map[string]string) error
```



<a name="ModuleConfiguration"></a>
## type [ModuleConfiguration](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/module.go#L9-L11>)



```go
type ModuleConfiguration struct {
    NSCacheConfiguration ledgercontroller.CacheConfiguration
}
```

<a name="Option"></a>
## type [Option](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L109>)



```go
type Option func(r *DefaultController)
```

<a name="WithCompiler"></a>
### func [WithCompiler](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/controller.go#L111>)

```go
func WithCompiler(compiler ledgercontroller.Compiler) Option
```



<a name="Store"></a>
## type [Store](<https://github.com/formancehq/ledger/blob/main/internal/controller/system/store.go#L13-L20>)



```go
type Store interface {
    GetLedger(ctx context.Context, name string) (*ledger.Ledger, error)
    ListLedgers(ctx context.Context, query ledgercontroller.ListLedgersQuery) (*bunpaginate.Cursor[ledger.Ledger], error)
    UpdateLedgerMetadata(ctx context.Context, name string, m metadata.Metadata) error
    DeleteLedgerMetadata(ctx context.Context, param string, key string) error
    OpenLedger(context.Context, string) (ledgercontroller.Store, *ledger.Ledger, error)
    CreateLedger(context.Context, *ledger.Ledger) error
}
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
