<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# ledger

```go
import "github.com/formancehq/ledger/internal"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func ComputeIdempotencyHash\(inputs any\) string](<#ComputeIdempotencyHash>)
- [func ComputeMetadata\(key, value string\) metadata.Metadata](<#ComputeMetadata>)
- [func MarkReverts\(m metadata.Metadata, txID int\) metadata.Metadata](<#MarkReverts>)
- [func RevertMetadata\(txID int\) metadata.Metadata](<#RevertMetadata>)
- [func RevertMetadataSpecKey\(\) string](<#RevertMetadataSpecKey>)
- [func SpecMetadata\(name string\) string](<#SpecMetadata>)
- [type Account](<#Account>)
  - [func \(a Account\) GetAddress\(\) string](<#Account.GetAddress>)
- [type AccountMetadata](<#AccountMetadata>)
- [type AccountsVolumes](<#AccountsVolumes>)
- [type AggregatedVolumes](<#AggregatedVolumes>)
- [type BalancesByAssets](<#BalancesByAssets>)
- [type BalancesByAssetsByAccounts](<#BalancesByAssetsByAccounts>)
- [type Configuration](<#Configuration>)
  - [func NewDefaultConfiguration\(\) Configuration](<#NewDefaultConfiguration>)
  - [func \(c \*Configuration\) SetDefaults\(\)](<#Configuration.SetDefaults>)
  - [func \(c \*Configuration\) Validate\(\) error](<#Configuration.Validate>)
- [type CreatedTransaction](<#CreatedTransaction>)
  - [func \(p CreatedTransaction\) GetMemento\(\) any](<#CreatedTransaction.GetMemento>)
  - [func \(p CreatedTransaction\) Type\(\) LogType](<#CreatedTransaction.Type>)
- [type DeletedMetadata](<#DeletedMetadata>)
  - [func \(s DeletedMetadata\) Type\(\) LogType](<#DeletedMetadata.Type>)
  - [func \(s \*DeletedMetadata\) UnmarshalJSON\(data \[\]byte\) error](<#DeletedMetadata.UnmarshalJSON>)
- [type ErrInvalidBucketName](<#ErrInvalidBucketName>)
  - [func \(e ErrInvalidBucketName\) Error\(\) string](<#ErrInvalidBucketName.Error>)
  - [func \(e ErrInvalidBucketName\) Is\(err error\) bool](<#ErrInvalidBucketName.Is>)
- [type ErrInvalidLedgerName](<#ErrInvalidLedgerName>)
  - [func \(e ErrInvalidLedgerName\) Error\(\) string](<#ErrInvalidLedgerName.Error>)
  - [func \(e ErrInvalidLedgerName\) Is\(err error\) bool](<#ErrInvalidLedgerName.Is>)
- [type Ledger](<#Ledger>)
  - [func MustNewWithDefault\(name string\) Ledger](<#MustNewWithDefault>)
  - [func New\(name string, configuration Configuration\) \(\*Ledger, error\)](<#New>)
  - [func NewWithDefaults\(name string\) \(\*Ledger, error\)](<#NewWithDefaults>)
  - [func \(l Ledger\) HasFeature\(feature, value string\) bool](<#Ledger.HasFeature>)
  - [func \(l Ledger\) WithMetadata\(m metadata.Metadata\) Ledger](<#Ledger.WithMetadata>)
- [type Log](<#Log>)
  - [func NewLog\(payload LogPayload\) Log](<#NewLog>)
  - [func \(l Log\) ChainLog\(previous \*Log\) Log](<#Log.ChainLog>)
  - [func \(l \*Log\) ComputeHash\(previous \*Log\)](<#Log.ComputeHash>)
  - [func \(l \*Log\) UnmarshalJSON\(data \[\]byte\) error](<#Log.UnmarshalJSON>)
  - [func \(l Log\) WithID\(i int\) Log](<#Log.WithID>)
  - [func \(l Log\) WithIdempotencyKey\(key string\) Log](<#Log.WithIdempotencyKey>)
- [type LogPayload](<#LogPayload>)
  - [func HydrateLog\(\_type LogType, data \[\]byte\) \(LogPayload, error\)](<#HydrateLog>)
- [type LogType](<#LogType>)
  - [func LogTypeFromString\(logType string\) LogType](<#LogTypeFromString>)
  - [func \(lt LogType\) MarshalJSON\(\) \(\[\]byte, error\)](<#LogType.MarshalJSON>)
  - [func \(lt \*LogType\) Scan\(src interface\{\}\) error](<#LogType.Scan>)
  - [func \(lt LogType\) String\(\) string](<#LogType.String>)
  - [func \(lt \*LogType\) UnmarshalJSON\(data \[\]byte\) error](<#LogType.UnmarshalJSON>)
  - [func \(lt LogType\) Value\(\) \(driver.Value, error\)](<#LogType.Value>)
- [type Memento](<#Memento>)
- [type Move](<#Move>)
- [type Moves](<#Moves>)
  - [func \(m Moves\) ComputePostCommitEffectiveVolumes\(\) PostCommitVolumes](<#Moves.ComputePostCommitEffectiveVolumes>)
- [type PostCommitVolumes](<#PostCommitVolumes>)
  - [func \(a PostCommitVolumes\) AddInput\(account, asset string, input \*big.Int\)](<#PostCommitVolumes.AddInput>)
  - [func \(a PostCommitVolumes\) AddOutput\(account, asset string, output \*big.Int\)](<#PostCommitVolumes.AddOutput>)
  - [func \(a PostCommitVolumes\) Copy\(\) PostCommitVolumes](<#PostCommitVolumes.Copy>)
  - [func \(a PostCommitVolumes\) Merge\(volumes PostCommitVolumes\) PostCommitVolumes](<#PostCommitVolumes.Merge>)
- [type Posting](<#Posting>)
  - [func NewPosting\(source string, destination string, asset string, amount \*big.Int\) Posting](<#NewPosting>)
- [type Postings](<#Postings>)
  - [func \(p Postings\) Reverse\(\) Postings](<#Postings.Reverse>)
  - [func \(p Postings\) Validate\(\) \(int, error\)](<#Postings.Validate>)
- [type RevertedTransaction](<#RevertedTransaction>)
  - [func \(r RevertedTransaction\) GetMemento\(\) any](<#RevertedTransaction.GetMemento>)
  - [func \(r RevertedTransaction\) Type\(\) LogType](<#RevertedTransaction.Type>)
- [type SavedMetadata](<#SavedMetadata>)
  - [func \(s SavedMetadata\) Type\(\) LogType](<#SavedMetadata.Type>)
  - [func \(s \*SavedMetadata\) UnmarshalJSON\(data \[\]byte\) error](<#SavedMetadata.UnmarshalJSON>)
- [type Transaction](<#Transaction>)
  - [func NewTransaction\(\) Transaction](<#NewTransaction>)
  - [func \(tx Transaction\) InvolvedAccounts\(\) \[\]string](<#Transaction.InvolvedAccounts>)
  - [func \(tx Transaction\) InvolvedDestinations\(\) map\[string\]\[\]string](<#Transaction.InvolvedDestinations>)
  - [func \(tx Transaction\) IsReverted\(\) bool](<#Transaction.IsReverted>)
  - [func \(Transaction\) JSONSchemaExtend\(schema \*jsonschema.Schema\)](<#Transaction.JSONSchemaExtend>)
  - [func \(tx Transaction\) MarshalJSON\(\) \(\[\]byte, error\)](<#Transaction.MarshalJSON>)
  - [func \(tx Transaction\) Reverse\(\) Transaction](<#Transaction.Reverse>)
  - [func \(tx Transaction\) VolumeUpdates\(\) \[\]AccountsVolumes](<#Transaction.VolumeUpdates>)
  - [func \(tx Transaction\) WithID\(id int\) Transaction](<#Transaction.WithID>)
  - [func \(tx Transaction\) WithInsertedAt\(date time.Time\) Transaction](<#Transaction.WithInsertedAt>)
  - [func \(tx Transaction\) WithMetadata\(m metadata.Metadata\) Transaction](<#Transaction.WithMetadata>)
  - [func \(tx Transaction\) WithPostCommitEffectiveVolumes\(volumes PostCommitVolumes\) Transaction](<#Transaction.WithPostCommitEffectiveVolumes>)
  - [func \(tx Transaction\) WithPostings\(postings ...Posting\) Transaction](<#Transaction.WithPostings>)
  - [func \(tx Transaction\) WithReference\(ref string\) Transaction](<#Transaction.WithReference>)
  - [func \(tx Transaction\) WithRevertedAt\(timestamp time.Time\) Transaction](<#Transaction.WithRevertedAt>)
  - [func \(tx Transaction\) WithTimestamp\(ts time.Time\) Transaction](<#Transaction.WithTimestamp>)
- [type TransactionData](<#TransactionData>)
  - [func NewTransactionData\(\) TransactionData](<#NewTransactionData>)
  - [func \(data TransactionData\) WithPostings\(postings ...Posting\) TransactionData](<#TransactionData.WithPostings>)
- [type Transactions](<#Transactions>)
- [type Volumes](<#Volumes>)
  - [func NewEmptyVolumes\(\) Volumes](<#NewEmptyVolumes>)
  - [func NewVolumesInt64\(input, output int64\) Volumes](<#NewVolumesInt64>)
  - [func \(v Volumes\) Balance\(\) \*big.Int](<#Volumes.Balance>)
  - [func \(v Volumes\) Copy\(\) Volumes](<#Volumes.Copy>)
  - [func \(Volumes\) JSONSchemaExtend\(schema \*jsonschema.Schema\)](<#Volumes.JSONSchemaExtend>)
  - [func \(v Volumes\) MarshalJSON\(\) \(\[\]byte, error\)](<#Volumes.MarshalJSON>)
  - [func \(v \*Volumes\) Scan\(src interface\{\}\) error](<#Volumes.Scan>)
  - [func \(v Volumes\) Value\(\) \(driver.Value, error\)](<#Volumes.Value>)
- [type VolumesByAssets](<#VolumesByAssets>)
  - [func \(v VolumesByAssets\) Balances\(\) BalancesByAssets](<#VolumesByAssets.Balances>)
- [type VolumesWithBalance](<#VolumesWithBalance>)
- [type VolumesWithBalanceByAssetByAccount](<#VolumesWithBalanceByAssetByAccount>)
- [type VolumesWithBalanceByAssets](<#VolumesWithBalanceByAssets>)


## Constants

<a name="StateInitializing"></a>

```go
const (
    StateInitializing = "initializing"
    StateInUse        = "in-use"
)
```

<a name="MetaTargetTypeAccount"></a>

```go
const (
    MetaTargetTypeAccount     = "ACCOUNT"
    MetaTargetTypeTransaction = "TRANSACTION"
)
```

<a name="DefaultBucket"></a>

```go
const (
    DefaultBucket = "_default"
)
```

<a name="WORLD"></a>

```go
const (
    WORLD = "world"
)
```

## Variables

<a name="Zero"></a>

```go
var Zero = big.NewInt(0)
```

<a name="ComputeIdempotencyHash"></a>
## func ComputeIdempotencyHash

```go
func ComputeIdempotencyHash(inputs any) string
```



<a name="ComputeMetadata"></a>
## func ComputeMetadata

```go
func ComputeMetadata(key, value string) metadata.Metadata
```



<a name="MarkReverts"></a>
## func MarkReverts

```go
func MarkReverts(m metadata.Metadata, txID int) metadata.Metadata
```



<a name="RevertMetadata"></a>
## func RevertMetadata

```go
func RevertMetadata(txID int) metadata.Metadata
```



<a name="RevertMetadataSpecKey"></a>
## func RevertMetadataSpecKey

```go
func RevertMetadataSpecKey() string
```



<a name="SpecMetadata"></a>
## func SpecMetadata

```go
func SpecMetadata(name string) string
```



<a name="Account"></a>
## type Account



```go
type Account struct {
    bun.BaseModel `bun:"table:accounts"`

    Address          string            `json:"address" bun:"address"`
    Metadata         metadata.Metadata `json:"metadata" bun:"metadata,type:jsonb,default:'{}'"`
    FirstUsage       time.Time         `json:"-" bun:"first_usage,nullzero"`
    InsertionDate    time.Time         `json:"-" bun:"insertion_date,nullzero"`
    UpdatedAt        time.Time         `json:"-" bun:"updated_at,nullzero"`
    Volumes          VolumesByAssets   `json:"volumes,omitempty" bun:"volumes,scanonly"`
    EffectiveVolumes VolumesByAssets   `json:"effectiveVolumes,omitempty" bun:"effective_volumes,scanonly"`
}
```

<a name="Account.GetAddress"></a>
### func \(Account\) GetAddress

```go
func (a Account) GetAddress() string
```



<a name="AccountMetadata"></a>
## type AccountMetadata



```go
type AccountMetadata map[string]metadata.Metadata
```

<a name="AccountsVolumes"></a>
## type AccountsVolumes



```go
type AccountsVolumes struct {
    bun.BaseModel `bun:"accounts_volumes"`

    Account string   `bun:"accounts_address,type:varchar"`
    Asset   string   `bun:"asset,type:varchar"`
    Input   *big.Int `bun:"input,type:numeric"`
    Output  *big.Int `bun:"output,type:numeric"`
}
```

<a name="AggregatedVolumes"></a>
## type AggregatedVolumes



```go
type AggregatedVolumes struct {
    Aggregated VolumesByAssets `bun:"aggregated,type:jsonb"`
}
```

<a name="BalancesByAssets"></a>
## type BalancesByAssets



```go
type BalancesByAssets map[string]*big.Int
```

<a name="BalancesByAssetsByAccounts"></a>
## type BalancesByAssetsByAccounts



```go
type BalancesByAssetsByAccounts map[string]BalancesByAssets
```

<a name="Configuration"></a>
## type Configuration



```go
type Configuration struct {
    Bucket   string              `json:"bucket" bun:"bucket,type:varchar(255)"`
    Metadata metadata.Metadata   `json:"metadata" bun:"metadata,type:jsonb"`
    Features features.FeatureSet `json:"features" bun:"features,type:jsonb"`
}
```

<a name="NewDefaultConfiguration"></a>
### func NewDefaultConfiguration

```go
func NewDefaultConfiguration() Configuration
```



<a name="Configuration.SetDefaults"></a>
### func \(\*Configuration\) SetDefaults

```go
func (c *Configuration) SetDefaults()
```



<a name="Configuration.Validate"></a>
### func \(\*Configuration\) Validate

```go
func (c *Configuration) Validate() error
```



<a name="CreatedTransaction"></a>
## type CreatedTransaction



```go
type CreatedTransaction struct {
    Transaction     Transaction     `json:"transaction"`
    AccountMetadata AccountMetadata `json:"accountMetadata"`
}
```

<a name="CreatedTransaction.GetMemento"></a>
### func \(CreatedTransaction\) GetMemento

```go
func (p CreatedTransaction) GetMemento() any
```



<a name="CreatedTransaction.Type"></a>
### func \(CreatedTransaction\) Type

```go
func (p CreatedTransaction) Type() LogType
```



<a name="DeletedMetadata"></a>
## type DeletedMetadata



```go
type DeletedMetadata struct {
    TargetType string `json:"targetType"`
    TargetID   any    `json:"targetId"`
    Key        string `json:"key"`
}
```

<a name="DeletedMetadata.Type"></a>
### func \(DeletedMetadata\) Type

```go
func (s DeletedMetadata) Type() LogType
```



<a name="DeletedMetadata.UnmarshalJSON"></a>
### func \(\*DeletedMetadata\) UnmarshalJSON

```go
func (s *DeletedMetadata) UnmarshalJSON(data []byte) error
```



<a name="ErrInvalidBucketName"></a>
## type ErrInvalidBucketName



```go
type ErrInvalidBucketName struct {
    // contains filtered or unexported fields
}
```

<a name="ErrInvalidBucketName.Error"></a>
### func \(ErrInvalidBucketName\) Error

```go
func (e ErrInvalidBucketName) Error() string
```



<a name="ErrInvalidBucketName.Is"></a>
### func \(ErrInvalidBucketName\) Is

```go
func (e ErrInvalidBucketName) Is(err error) bool
```



<a name="ErrInvalidLedgerName"></a>
## type ErrInvalidLedgerName



```go
type ErrInvalidLedgerName struct {
    // contains filtered or unexported fields
}
```

<a name="ErrInvalidLedgerName.Error"></a>
### func \(ErrInvalidLedgerName\) Error

```go
func (e ErrInvalidLedgerName) Error() string
```



<a name="ErrInvalidLedgerName.Is"></a>
### func \(ErrInvalidLedgerName\) Is

```go
func (e ErrInvalidLedgerName) Is(err error) bool
```



<a name="Ledger"></a>
## type Ledger



```go
type Ledger struct {
    bun.BaseModel `bun:"_system.ledgers,alias:ledgers"`

    Configuration
    ID      int       `json:"id" bun:"id,type:int,scanonly"`
    Name    string    `json:"name" bun:"name,type:varchar(255),pk"`
    AddedAt time.Time `json:"addedAt" bun:"added_at,type:timestamp,nullzero"`
    State   string    `json:"-" bun:"state,type:varchar(255),nullzero"`
}
```

<a name="MustNewWithDefault"></a>
### func MustNewWithDefault

```go
func MustNewWithDefault(name string) Ledger
```



<a name="New"></a>
### func New

```go
func New(name string, configuration Configuration) (*Ledger, error)
```



<a name="NewWithDefaults"></a>
### func NewWithDefaults

```go
func NewWithDefaults(name string) (*Ledger, error)
```



<a name="Ledger.HasFeature"></a>
### func \(Ledger\) HasFeature

```go
func (l Ledger) HasFeature(feature, value string) bool
```



<a name="Ledger.WithMetadata"></a>
### func \(Ledger\) WithMetadata

```go
func (l Ledger) WithMetadata(m metadata.Metadata) Ledger
```



<a name="Log"></a>
## type Log

Log represents atomic actions made on the ledger.

```go
type Log struct {
    bun.BaseModel `bun:"table:logs,alias:logs"`

    Type           LogType    `json:"type" bun:"type,type:log_type"`
    Data           LogPayload `json:"data" bun:"data,type:jsonb"`
    Date           time.Time  `json:"date" bun:"date,type:timestamptz,nullzero"`
    IdempotencyKey string     `json:"idempotencyKey" bun:"idempotency_key,type:varchar(256),unique,nullzero"`
    // IdempotencyHash is a signature used when using IdempotencyKey.
    // It allows to check if the usage of IdempotencyKey match inputs given on the first idempotency key usage.
    IdempotencyHash string `json:"idempotencyHash" bun:"idempotency_hash,unique,nullzero"`
    ID              *int   `json:"id" bun:"id,unique,type:numeric"`
    Hash            []byte `json:"hash" bun:"hash,type:bytea"`
}
```

<a name="NewLog"></a>
### func NewLog

```go
func NewLog(payload LogPayload) Log
```



<a name="Log.ChainLog"></a>
### func \(Log\) ChainLog

```go
func (l Log) ChainLog(previous *Log) Log
```



<a name="Log.ComputeHash"></a>
### func \(\*Log\) ComputeHash

```go
func (l *Log) ComputeHash(previous *Log)
```



<a name="Log.UnmarshalJSON"></a>
### func \(\*Log\) UnmarshalJSON

```go
func (l *Log) UnmarshalJSON(data []byte) error
```



<a name="Log.WithID"></a>
### func \(Log\) WithID

```go
func (l Log) WithID(i int) Log
```



<a name="Log.WithIdempotencyKey"></a>
### func \(Log\) WithIdempotencyKey

```go
func (l Log) WithIdempotencyKey(key string) Log
```



<a name="LogPayload"></a>
## type LogPayload



```go
type LogPayload interface {
    Type() LogType
}
```

<a name="HydrateLog"></a>
### func HydrateLog

```go
func HydrateLog(_type LogType, data []byte) (LogPayload, error)
```



<a name="LogType"></a>
## type LogType



```go
type LogType int16
```

<a name="SetMetadataLogType"></a>

```go
const (
    SetMetadataLogType         LogType = iota // "SET_METADATA"
    NewLogType                                // "NEW_TRANSACTION"
    RevertedTransactionLogType                // "REVERTED_TRANSACTION"
    DeleteMetadataLogType
)
```

<a name="LogTypeFromString"></a>
### func LogTypeFromString

```go
func LogTypeFromString(logType string) LogType
```



<a name="LogType.MarshalJSON"></a>
### func \(LogType\) MarshalJSON

```go
func (lt LogType) MarshalJSON() ([]byte, error)
```



<a name="LogType.Scan"></a>
### func \(\*LogType\) Scan

```go
func (lt *LogType) Scan(src interface{}) error
```



<a name="LogType.String"></a>
### func \(LogType\) String

```go
func (lt LogType) String() string
```



<a name="LogType.UnmarshalJSON"></a>
### func \(\*LogType\) UnmarshalJSON

```go
func (lt *LogType) UnmarshalJSON(data []byte) error
```



<a name="LogType.Value"></a>
### func \(LogType\) Value

```go
func (lt LogType) Value() (driver.Value, error)
```



<a name="Memento"></a>
## type Memento



```go
type Memento interface {
    GetMemento() any
}
```

<a name="Move"></a>
## type Move



```go
type Move struct {
    bun.BaseModel `bun:"table:moves"`

    TransactionID              int                 `bun:"transactions_id,type:bigint"`
    IsSource                   bool                `bun:"is_source,type:bool"`
    Account                    string              `bun:"accounts_address,type:varchar"`
    Amount                     *bunpaginate.BigInt `bun:"amount,type:numeric"`
    Asset                      string              `bun:"asset,type:varchar"`
    InsertionDate              time.Time           `bun:"insertion_date,type:timestamp,nullzero"`
    EffectiveDate              time.Time           `bun:"effective_date,type:timestamp,nullzero"`
    PostCommitVolumes          *Volumes            `bun:"post_commit_volumes,type:jsonb"`
    PostCommitEffectiveVolumes *Volumes            `bun:"post_commit_effective_volumes,type:jsonb,scanonly"`
}
```

<a name="Moves"></a>
## type Moves



```go
type Moves []*Move
```

<a name="Moves.ComputePostCommitEffectiveVolumes"></a>
### func \(Moves\) ComputePostCommitEffectiveVolumes

```go
func (m Moves) ComputePostCommitEffectiveVolumes() PostCommitVolumes
```



<a name="PostCommitVolumes"></a>
## type PostCommitVolumes



```go
type PostCommitVolumes map[string]VolumesByAssets
```

<a name="PostCommitVolumes.AddInput"></a>
### func \(PostCommitVolumes\) AddInput

```go
func (a PostCommitVolumes) AddInput(account, asset string, input *big.Int)
```



<a name="PostCommitVolumes.AddOutput"></a>
### func \(PostCommitVolumes\) AddOutput

```go
func (a PostCommitVolumes) AddOutput(account, asset string, output *big.Int)
```



<a name="PostCommitVolumes.Copy"></a>
### func \(PostCommitVolumes\) Copy

```go
func (a PostCommitVolumes) Copy() PostCommitVolumes
```



<a name="PostCommitVolumes.Merge"></a>
### func \(PostCommitVolumes\) Merge

```go
func (a PostCommitVolumes) Merge(volumes PostCommitVolumes) PostCommitVolumes
```



<a name="Posting"></a>
## type Posting



```go
type Posting struct {
    Source      string   `json:"source"`
    Destination string   `json:"destination"`
    Amount      *big.Int `json:"amount"`
    Asset       string   `json:"asset"`
}
```

<a name="NewPosting"></a>
### func NewPosting

```go
func NewPosting(source string, destination string, asset string, amount *big.Int) Posting
```



<a name="Postings"></a>
## type Postings



```go
type Postings []Posting
```

<a name="Postings.Reverse"></a>
### func \(Postings\) Reverse

```go
func (p Postings) Reverse() Postings
```



<a name="Postings.Validate"></a>
### func \(Postings\) Validate

```go
func (p Postings) Validate() (int, error)
```



<a name="RevertedTransaction"></a>
## type RevertedTransaction



```go
type RevertedTransaction struct {
    RevertedTransaction Transaction `json:"revertedTransaction"`
    RevertTransaction   Transaction `json:"transaction"`
}
```

<a name="RevertedTransaction.GetMemento"></a>
### func \(RevertedTransaction\) GetMemento

```go
func (r RevertedTransaction) GetMemento() any
```



<a name="RevertedTransaction.Type"></a>
### func \(RevertedTransaction\) Type

```go
func (r RevertedTransaction) Type() LogType
```



<a name="SavedMetadata"></a>
## type SavedMetadata



```go
type SavedMetadata struct {
    TargetType string            `json:"targetType"`
    TargetID   any               `json:"targetId"`
    Metadata   metadata.Metadata `json:"metadata"`
}
```

<a name="SavedMetadata.Type"></a>
### func \(SavedMetadata\) Type

```go
func (s SavedMetadata) Type() LogType
```



<a name="SavedMetadata.UnmarshalJSON"></a>
### func \(\*SavedMetadata\) UnmarshalJSON

```go
func (s *SavedMetadata) UnmarshalJSON(data []byte) error
```



<a name="Transaction"></a>
## type Transaction



```go
type Transaction struct {
    bun.BaseModel `bun:"table:transactions,alias:transactions"`

    TransactionData
    ID         *int       `json:"id" bun:"id,type:numeric"`
    RevertedAt *time.Time `json:"revertedAt,omitempty" bun:"reverted_at,type:timestamp without time zone"`
    // PostCommitVolumes are the volumes of each account/asset after a transaction has been committed.
    // Those volumes will never change as those are computed in flight.
    PostCommitVolumes PostCommitVolumes `json:"postCommitVolumes,omitempty" bun:"post_commit_volumes,type:jsonb"`
    // PostCommitEffectiveVolumes are the volumes of each account/asset after the transaction TransactionData.Timestamp.
    // Those volumes are also computed in flight, but can be updated if a transaction is inserted in the past.
    PostCommitEffectiveVolumes PostCommitVolumes `json:"postCommitEffectiveVolumes,omitempty" bun:"post_commit_effective_volumes,type:jsonb,scanonly"`
}
```

<a name="NewTransaction"></a>
### func NewTransaction

```go
func NewTransaction() Transaction
```



<a name="Transaction.InvolvedAccounts"></a>
### func \(Transaction\) InvolvedAccounts

```go
func (tx Transaction) InvolvedAccounts() []string
```



<a name="Transaction.InvolvedDestinations"></a>
### func \(Transaction\) InvolvedDestinations

```go
func (tx Transaction) InvolvedDestinations() map[string][]string
```



<a name="Transaction.IsReverted"></a>
### func \(Transaction\) IsReverted

```go
func (tx Transaction) IsReverted() bool
```



<a name="Transaction.JSONSchemaExtend"></a>
### func \(Transaction\) JSONSchemaExtend

```go
func (Transaction) JSONSchemaExtend(schema *jsonschema.Schema)
```



<a name="Transaction.MarshalJSON"></a>
### func \(Transaction\) MarshalJSON

```go
func (tx Transaction) MarshalJSON() ([]byte, error)
```



<a name="Transaction.Reverse"></a>
### func \(Transaction\) Reverse

```go
func (tx Transaction) Reverse() Transaction
```



<a name="Transaction.VolumeUpdates"></a>
### func \(Transaction\) VolumeUpdates

```go
func (tx Transaction) VolumeUpdates() []AccountsVolumes
```



<a name="Transaction.WithID"></a>
### func \(Transaction\) WithID

```go
func (tx Transaction) WithID(id int) Transaction
```



<a name="Transaction.WithInsertedAt"></a>
### func \(Transaction\) WithInsertedAt

```go
func (tx Transaction) WithInsertedAt(date time.Time) Transaction
```



<a name="Transaction.WithMetadata"></a>
### func \(Transaction\) WithMetadata

```go
func (tx Transaction) WithMetadata(m metadata.Metadata) Transaction
```



<a name="Transaction.WithPostCommitEffectiveVolumes"></a>
### func \(Transaction\) WithPostCommitEffectiveVolumes

```go
func (tx Transaction) WithPostCommitEffectiveVolumes(volumes PostCommitVolumes) Transaction
```



<a name="Transaction.WithPostings"></a>
### func \(Transaction\) WithPostings

```go
func (tx Transaction) WithPostings(postings ...Posting) Transaction
```



<a name="Transaction.WithReference"></a>
### func \(Transaction\) WithReference

```go
func (tx Transaction) WithReference(ref string) Transaction
```



<a name="Transaction.WithRevertedAt"></a>
### func \(Transaction\) WithRevertedAt

```go
func (tx Transaction) WithRevertedAt(timestamp time.Time) Transaction
```



<a name="Transaction.WithTimestamp"></a>
### func \(Transaction\) WithTimestamp

```go
func (tx Transaction) WithTimestamp(ts time.Time) Transaction
```



<a name="TransactionData"></a>
## type TransactionData



```go
type TransactionData struct {
    Postings   Postings          `json:"postings" bun:"postings,type:jsonb"`
    Metadata   metadata.Metadata `json:"metadata" bun:"metadata,type:jsonb,default:'{}'"`
    Timestamp  time.Time         `json:"timestamp" bun:"timestamp,type:timestamp without time zone,nullzero"`
    Reference  string            `json:"reference,omitempty" bun:"reference,type:varchar,unique,nullzero"`
    InsertedAt time.Time         `json:"insertedAt,omitempty" bun:"inserted_at,type:timestamp without time zone,nullzero"`
}
```

<a name="NewTransactionData"></a>
### func NewTransactionData

```go
func NewTransactionData() TransactionData
```



<a name="TransactionData.WithPostings"></a>
### func \(TransactionData\) WithPostings

```go
func (data TransactionData) WithPostings(postings ...Posting) TransactionData
```



<a name="Transactions"></a>
## type Transactions



```go
type Transactions struct {
    Transactions []TransactionData `json:"transactions"`
}
```

<a name="Volumes"></a>
## type Volumes



```go
type Volumes struct {
    Input  *big.Int `json:"input"`
    Output *big.Int `json:"output"`
}
```

<a name="NewEmptyVolumes"></a>
### func NewEmptyVolumes

```go
func NewEmptyVolumes() Volumes
```



<a name="NewVolumesInt64"></a>
### func NewVolumesInt64

```go
func NewVolumesInt64(input, output int64) Volumes
```



<a name="Volumes.Balance"></a>
### func \(Volumes\) Balance

```go
func (v Volumes) Balance() *big.Int
```



<a name="Volumes.Copy"></a>
### func \(Volumes\) Copy

```go
func (v Volumes) Copy() Volumes
```



<a name="Volumes.JSONSchemaExtend"></a>
### func \(Volumes\) JSONSchemaExtend

```go
func (Volumes) JSONSchemaExtend(schema *jsonschema.Schema)
```



<a name="Volumes.MarshalJSON"></a>
### func \(Volumes\) MarshalJSON

```go
func (v Volumes) MarshalJSON() ([]byte, error)
```



<a name="Volumes.Scan"></a>
### func \(\*Volumes\) Scan

```go
func (v *Volumes) Scan(src interface{}) error
```



<a name="Volumes.Value"></a>
### func \(Volumes\) Value

```go
func (v Volumes) Value() (driver.Value, error)
```



<a name="VolumesByAssets"></a>
## type VolumesByAssets



```go
type VolumesByAssets map[string]Volumes
```

<a name="VolumesByAssets.Balances"></a>
### func \(VolumesByAssets\) Balances

```go
func (v VolumesByAssets) Balances() BalancesByAssets
```



<a name="VolumesWithBalance"></a>
## type VolumesWithBalance



```go
type VolumesWithBalance struct {
    Input   *big.Int `json:"input" bun:"input"`
    Output  *big.Int `json:"output" bun:"output"`
    Balance *big.Int `json:"balance" bun:"balance"`
}
```

<a name="VolumesWithBalanceByAssetByAccount"></a>
## type VolumesWithBalanceByAssetByAccount



```go
type VolumesWithBalanceByAssetByAccount struct {
    Account string `json:"account" bun:"account"`
    Asset   string `json:"asset" bun:"asset"`
    VolumesWithBalance
}
```

<a name="VolumesWithBalanceByAssets"></a>
## type VolumesWithBalanceByAssets



```go
type VolumesWithBalanceByAssets map[string]*VolumesWithBalance
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
