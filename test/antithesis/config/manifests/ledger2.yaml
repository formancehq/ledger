apiVersion: v1
kind: Service
metadata:
  name: ledger2
  namespace: formance-dev
spec:
  selector:
    app: ledger2
  ports:
    - protocol: TCP
      port: 8080
      targetPort: 8080
---
apiVersion: v1
kind: Pod
metadata:
  name: ledger2
  namespace: formance-dev
  labels:
    app: ledger2
spec:
  containers:
    - name: ledger
      image: us-central1-docker.pkg.dev/molten-verve-216720/formance-repository/ledger:k8s_test
      imagePullPolicy: IfNotPresent
      env:
        - name: "POSTGRES_URI"
          value: "postgresql://ledger:ledger@postgres:5432/ledger?sslmode=disable"
        - name: "BIND"
          value: ":8080"
        - name: "POSTGRES_CONN_MAX_IDLE_TIME"
          value: "1m0s"
        - name: "POSTGRES_MAX_IDLE_CONNS"
          value: "20"
        - name: "POSTGRES_MAX_OPEN_CONNS"
          value: "20"
  # imagePullSecrets:
  #   - name: antithesis
